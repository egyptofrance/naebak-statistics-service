# 📊 خدمة الإحصائيات - Naebak Statistics Service

**خدمة مصغرة لجمع وعرض إحصائيات منصة نائبك**

---

## 🎯 الوصف

هذه خدمة مصغرة مخصصة لجمع وعرض الإحصائيات الأساسية لمنصة نائبك، تشمل:
- إحصائيات المستخدمين (مواطنين، مرشحين، أعضاء)
- إحصائيات الرسائل والشكاوى والتقييمات
- إحصائيات المحافظات والأحزاب
- البيانات المرجعية الأساسية

---

## 🛠️ التقنيات المستخدمة

- **Flask 2.3.3** - إطار العمل الأساسي
- **Redis 5.0.1** - قاعدة البيانات للتخزين السريع
- **Python 3.11+** - لغة البرمجة

---

## 📁 هيكل المشروع

```
naebak-statistics-service/
├── app.py              # التطبيق الرئيسي
├── config.py           # إعدادات التطبيق
├── models.py           # نماذج البيانات والخدمات
├── constants.py        # الثوابت والبيانات الأساسية
├── requirements.txt    # التبعيات المطلوبة
├── .env               # متغيرات البيئة
└── README.md          # هذا الملف
```

---

## ⚙️ الإعدادات

### متغيرات البيئة (.env)

```env
FLASK_APP=app.py
FLASK_ENV=development
REDIS_URL=redis://localhost:6379/0
SECRET_KEY=your-secret-key-here
PORT=8012
STATS_RETENTION_DAYS=90
REAL_TIME_ENABLED=true
AGGREGATION_INTERVAL=300
```

---

## 🚀 التشغيل

### 1. تثبيت التبعيات
```bash
pip install -r requirements.txt
```

### 2. تشغيل Redis
```bash
redis-server
```

### 3. تشغيل التطبيق
```bash
python app.py
```

---

## 📡 واجهات برمجة التطبيقات (APIs)

### الإحصائيات الأساسية

#### `GET /api/statistics/overall/`
الحصول على الإحصائيات الإجمالية

**استجابة مثال:**
```json
{
  "total_users": 1500,
  "total_citizens": 1200,
  "total_candidates": 200,
  "total_members": 100,
  "total_messages": 5000,
  "total_complaints": 800,
  "total_ratings": 2500,
  "resolved_complaints": 600,
  "pending_complaints": 200
}
```

#### `GET /api/statistics/governorate/{code}/`
إحصائيات محافظة معينة

#### `GET /api/statistics/party/{name}/`
إحصائيات حزب معين

### البيانات المرجعية

#### `GET /api/statistics/data/governorates/`
قائمة المحافظات المصرية (27 محافظة)

#### `GET /api/statistics/data/parties/`
قائمة الأحزاب السياسية المصرية

#### `GET /api/statistics/data/user-types/`
أنواع المستخدمين (مواطن، مرشح، عضو حالي)

#### `GET /api/statistics/data/councils/`
أنواع المجالس (النواب، الشيوخ)

#### `GET /api/statistics/data/complaint-categories/`
فئات الشكاوى

### أدوات التطوير

#### `POST /api/statistics/initialize/`
تهيئة البيانات الافتراضية للاختبار

#### `GET /health`
فحص صحة الخدمة

---

## 📊 البيانات الأساسية المتضمنة

### المحافظات (27 محافظة)
- القاهرة، الجيزة، الإسكندرية، الدقهلية، إلخ
- كل محافظة لها كود ثلاثي واسم بالعربية والإنجليزية

### الأحزاب السياسية (16 حزب)
- الوفد، الوطني الديمقراطي، الغد، التجمع، إلخ
- تشمل حزب "مستقل" للمرشحين المستقلين

### أنواع المستخدمين
- **مواطن:** له صوت انتخابي
- **مرشح:** مرشح لعضوية مجلس
- **عضو حالي:** عضو فعلي في مجلس
- **إدارة:** إدارة النظام

### أنواع المجالس
- **مجلس النواب:** 596 مقعد، مدة 5 سنوات
- **مجلس الشيوخ:** 300 مقعد، مدة 5 سنوات

### فئات الشكاوى (11 فئة)
- البنية التحتية، الصحة، التعليم، الأمن، إلخ

---

## 🔧 التطوير

هذه الخدمة جاهزة للتكامل مع باقي خدمات منصة نائبك:
- **خدمة المصادقة** - لإحصائيات المستخدمين
- **خدمة الشكاوى** - لإحصائيات الشكاوى
- **خدمة الرسائل** - لإحصائيات الرسائل
- **خدمة التقييمات** - لإحصائيات التقييمات

---

## 📝 ملاحظات

- البيانات الافتراضية للاختبار يتم تحميلها تلقائياً عند بدء التشغيل
- جميع البيانات المرجعية مأخوذة من مستودع المخزن الرسمي
- الخدمة مصممة للعمل على المنفذ 8012
- تدعم التشغيل في بيئة التطوير والإنتاج
